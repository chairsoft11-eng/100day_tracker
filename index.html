<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>ì•¼ê°„ê·¼ë¬´ í—¬ìŠ¤ì¼€ì–´</title>
    
    <!-- ì•„ì´í° í™ˆ í™”ë©´ ì¶”ê°€ ì‹œ ì•±ì²˜ëŸ¼ ë³´ì´ê²Œ í•˜ëŠ” ì„¤ì • -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="100ì¼í—¬ìŠ¤">
    <meta name="theme-color" content="#1e293b">

    <!-- ì•„ì´ì½˜ (ì„ì‹œ) -->
    <link rel="apple-touch-icon" href="https://cdn-icons-png.flaticon.com/512/2964/2964514.png">

    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- React & Babel -->
    <script src="https://unpkg.com/react@18/umd/react.production.min.js" crossorigin></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js" crossorigin></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <!-- Lucide Icons (Reactìš©ì´ ì•„ë‹Œ ì¼ë°˜ ìŠ¤í¬ë¦½íŠ¸ë¡œ ë¡œë“œ í›„ ì»´í¬ë„ŒíŠ¸í™”) -->
    <script src="https://unpkg.com/lucide@latest"></script>

    <style>
        /* iOS Safe Area ëŒ€ì‘ */
        body {
            padding-top: env(safe-area-inset-top);
            padding-bottom: env(safe-area-inset-bottom);
            background-color: #f9fafb; /* gray-50 */
            overscroll-behavior-y: none; /* ìŠ¤í¬ë¡¤ ë°”ìš´ìŠ¤ ë°©ì§€ */
            -webkit-tap-highlight-color: transparent;
        }
        
        /* ìŠ¤í¬ë¡¤ë°” ìˆ¨ê¸°ê¸° (ê¹”ë”í•˜ê²Œ) */
        ::-webkit-scrollbar {
            display: none;
        }
        
        /* í„°ì¹˜ ë°˜ì‘ì„± ê°œì„  */
        button {
            touch-action: manipulation;
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        // Lucide ì•„ì´ì½˜ì„ React ì»´í¬ë„ŒíŠ¸ë¡œ ì‚¬ìš©í•  ìˆ˜ ìˆê²Œ ë§¤í•‘
        const { useState, useEffect } = React;
        
        // ì•„ì´ì½˜ ì»´í¬ë„ŒíŠ¸ ë˜í¼
        const Icon = ({ name, size = 24, className, ...props }) => {
            useEffect(() => {
                lucide.createIcons();
            }, [name]);

            return <i data-lucide={name} width={size} height={size} className={className} {...props}></i>;
        };

        // ê°œë³„ ì•„ì´ì½˜ ì •ì˜ (lucide ë¼ì´ë¸ŒëŸ¬ë¦¬ ì´ë¦„ì„ ê·¸ëŒ€ë¡œ ì‚¬ìš©)
        const Trash2 = (props) => <Icon name="trash-2" {...props} />;
        const Save = (props) => <Icon name="save" {...props} />;
        const CalendarIcon = (props) => <Icon name="calendar" {...props} />;
        const Activity = (props) => <Icon name="activity" {...props} />;
        const Flame = (props) => <Icon name="flame" {...props} />;
        const Dumbbell = (props) => <Icon name="dumbbell" {...props} />;
        const Droplets = (props) => <Icon name="droplets" {...props} />;
        const Moon = (props) => <Icon name="moon" {...props} />;
        const BarChart2 = (props) => <Icon name="bar-chart-2" {...props} />;
        const List = (props) => <Icon name="list" {...props} />;
        const AlertCircle = (props) => <Icon name="alert-circle" {...props} />;
        const Bike = (props) => <Icon name="bike" {...props} />;
        const ChevronLeft = (props) => <Icon name="chevron-left" {...props} />;
        const ChevronRight = (props) => <Icon name="chevron-right" {...props} />;
        const Footprints = (props) => <Icon name="footprints" {...props} />;
        const LayoutGrid = (props) => <Icon name="layout-grid" {...props} />;

        function App() {
            // --- ìƒìˆ˜ ë° ì„¤ì • ---
            const START_DATE_STR = '2025-11-26';
            const TOTAL_DAYS = 100;
            const USER_PROFILE = {
                height: 150,
                startWeight: 59,
                goalWeight: 50,
                age: 33,
                bmr: 1132
            };

            // --- ìƒíƒœ ê´€ë¦¬ ---
            const [activeTab, setActiveTab] = useState('record'); // record, calendar, stats, routine
            const [entries, setEntries] = useState([]);
            const [dDayInfo, setDDayInfo] = useState({
                label: '',
                progress: 0,
                currentDay: 0,
                status: 'ready'
            });

            // ë‹¬ë ¥ìš© ìƒíƒœ
            const [currentDate, setCurrentDate] = useState(new Date());

            // ì…ë ¥ í¼ ìƒíƒœ
            const [formData, setFormData] = useState({
                date: new Date().toISOString().split('T')[0],
                weight: '',
                calories: '',
                water: 0,        // ml ë‹¨ìœ„
                sleepQuality: 3, // 1~5ì 
                kneePain: 0,     // 0~10ì 
                exercise: ''
            });

            // --- ì´ˆê¸° ë¡œë“œ ---
            useEffect(() => {
                const savedData = localStorage.getItem('diet_diary_entries_v2');
                if (savedData) {
                    setEntries(JSON.parse(savedData));
                }
                lucide.createIcons(); // ì´ˆê¸° ì•„ì´ì½˜ ë¡œë“œ
            }, []);

            // íƒ­ ë³€ê²½ì´ë‚˜ ë°ì´í„° ë³€ê²½ ì‹œ ì•„ì´ì½˜ ë‹¤ì‹œ ë¡œë“œ
            useEffect(() => {
                lucide.createIcons();
            }, [activeTab, entries, currentDate]);

            // --- ì €ì¥ ---
            useEffect(() => {
                localStorage.setItem('diet_diary_entries_v2', JSON.stringify(entries));
            }, [entries]);

            // --- D-Day ê³„ì‚° ---
            useEffect(() => {
                const calculateProgress = () => {
                    const start = new Date(START_DATE_STR);
                    start.setHours(0, 0, 0, 0);
                    const today = new Date();
                    today.setHours(0, 0, 0, 0);
                    const diffTime = today.getTime() - start.getTime();
                    const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24)); 
                    const currentDay = diffDays + 1;

                    let status = 'ready';
                    let progress = 0;
                    let label = '';

                    if (currentDay < 1) {
                        status = 'ready';
                        progress = 0;
                        label = `D${currentDay - 1}`;
                    } else if (currentDay > TOTAL_DAYS) {
                        status = 'ended';
                        progress = 100;
                        label = 'ì¢…ë£Œ!';
                    } else {
                        status = 'ongoing';
                        progress = (currentDay / TOTAL_DAYS) * 100;
                        label = `Day ${currentDay}`;
                    }
                    setDDayInfo({ label, progress, currentDay, status });
                };
                calculateProgress();
            }, []);

            // --- í•¸ë“¤ëŸ¬ ---
            const handleInputChange = (e) => {
                const { name, value } = e.target;
                setFormData(prev => ({ ...prev, [name]: value }));
            };

            const handleWaterAdd = (amount) => {
                setFormData(prev => ({ ...prev, water: Math.max(0, parseInt(prev.water || 0) + amount) }));
            };

            const handleSubmit = (e) => {
                e.preventDefault();
                if (!formData.date || !formData.weight || !formData.calories) {
                    alert('ë‚ ì§œ, ì²´ì¤‘, ì¹¼ë¡œë¦¬ëŠ” í•„ìˆ˜ì…ë‹ˆë‹¤.');
                    return;
                }

                const existingIndex = entries.findIndex(item => item.date === formData.date);
                let newEntries = [...entries];

                if (existingIndex !== -1) {
                    if (window.confirm(`${formData.date} ê¸°ë¡ì„ ìˆ˜ì •í•˜ì‹œê² ìŠµë‹ˆê¹Œ?`)) {
                        newEntries[existingIndex] = { ...formData };
                    } else { return; }
                } else {
                    newEntries.push({ ...formData });
                }

                newEntries.sort((a, b) => new Date(b.date) - new Date(a.date));
                setEntries(newEntries);
                
                // í¼ ë‚ ì§œëŠ” ìœ ì§€í•˜ë˜ ë‚´ìš©ì€ ì´ˆê¸°í™”
                setFormData(prev => ({
                    ...prev,
                    weight: '',
                    calories: '',
                    water: 0,
                    exercise: '',
                    sleepQuality: 3,
                    kneePain: 0
                }));
                alert('ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤!');
            };

            const handleDelete = (dateToDelete) => {
                if (window.confirm('ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
                    setEntries(entries.filter(item => item.date !== dateToDelete));
                }
            };

            // ë‹¬ë ¥ ë‚ ì§œ í´ë¦­ í•¸ë“¤ëŸ¬
            const handleDateClick = (day) => {
                const clickedDate = new Date(currentDate.getFullYear(), currentDate.getMonth(), day);
                const dateStr = new Date(clickedDate.getTime() - (clickedDate.getTimezoneOffset() * 60000)).toISOString().split('T')[0];
                
                const existingData = entries.find(e => e.date === dateStr);
                
                if (existingData) {
                    setFormData({ ...existingData });
                } else {
                    setFormData({
                        date: dateStr,
                        weight: '',
                        calories: '',
                        water: 0,
                        exercise: '',
                        sleepQuality: 3,
                        kneePain: 0
                    });
                }
                setActiveTab('record');
            };

            // --- í†µê³„ ê³„ì‚° ë„ìš°ë¯¸ ---
            const getAverage = (key) => {
                if (entries.length === 0) return 0;
                const sum = entries.reduce((acc, cur) => acc + Number(cur[key] || 0), 0);
                return (sum / entries.length).toFixed(1);
            };

            const getWeightChange = () => {
                if (entries.length < 2) return 0;
                const current = entries[0].weight; 
                const initial = entries[entries.length - 1].weight; 
                return (current - initial).toFixed(1);
            };

            // --- ë‹¬ë ¥ ë Œë”ë§ ë„ìš°ë¯¸ ---
            const renderCalendar = () => {
                const year = currentDate.getFullYear();
                const month = currentDate.getMonth();
                
                const firstDayOfMonth = new Date(year, month, 1).getDay();
                const daysInMonth = new Date(year, month + 1, 0).getDate();
                
                const days = [];
                for (let i = 0; i < firstDayOfMonth; i++) {
                    days.push(<div key={`empty-${i}`} className="aspect-square"></div>);
                }
                
                for (let day = 1; day <= daysInMonth; day++) {
                    const checkDate = new Date(year, month, day);
                    const checkDateStr = new Date(checkDate.getTime() - (checkDate.getTimezoneOffset() * 60000)).toISOString().split('T')[0];
                    
                    const entry = entries.find(e => e.date === checkDateStr);
                    const isToday = checkDateStr === new Date().toISOString().split('T')[0];

                    days.push(
                        <button
                            key={day}
                            onClick={() => handleDateClick(day)}
                            className={`aspect-square border border-slate-50 rounded-lg flex flex-col items-center justify-center relative transition-colors ${
                                isToday ? 'bg-blue-50 border-blue-200 shadow-sm' : 'hover:bg-slate-50'
                            }`}
                        >
                            <span className={`text-[10px] sm:text-xs font-bold ${isToday ? 'text-blue-600' : 'text-slate-700'}`}>{day}</span>
                            {entry && (
                                <div className="flex gap-0.5 mt-0.5 sm:mt-1">
                                    <div className={`w-1 h-1 sm:w-1.5 sm:h-1.5 rounded-full ${entry.kneePain >= 5 ? 'bg-red-400' : 'bg-green-400'}`}></div>
                                    {entry.exercise && <div className="w-1 h-1 sm:w-1.5 sm:h-1.5 rounded-full bg-purple-400"></div>}
                                </div>
                            )}
                        </button>
                    );
                }
                return days;
            };

            // --- ì»´í¬ë„ŒíŠ¸ ë Œë”ë§ ---
            return (
                <div className="min-h-screen pb-32">
                    
                    {/* ìƒë‹¨ í—¤ë” (Sticky) */}
                    <header className="bg-gradient-to-r from-slate-800 to-slate-900 text-white p-5 pt-6 pb-6 rounded-b-3xl shadow-xl sticky top-0 z-20">
                        <div className="max-w-md mx-auto">
                            <div className="flex justify-between items-end mb-3">
                                <div>
                                    <h1 className="text-lg font-bold flex items-center gap-2">
                                        <Moon className="text-yellow-300" size={20} />
                                        ì•¼ê°„ê·¼ë¬´ í—¬ìŠ¤ì¼€ì–´
                                    </h1>
                                    <p className="text-slate-400 text-[10px] mt-1">
                                        ëª©í‘œ: {USER_PROFILE.goalWeight}kg (í˜„ì¬ {entries[0]?.weight || USER_PROFILE.startWeight}kg)
                                    </p>
                                </div>
                                <div className="text-right">
                                    <div className="text-2xl font-extrabold text-blue-400">{dDayInfo.label}</div>
                                    <div className="text-[10px] text-slate-400">{Math.round(dDayInfo.progress)}% ë‹¬ì„±</div>
                                </div>
                            </div>
                            <div className="w-full bg-slate-700 h-2 rounded-full overflow-hidden">
                                <div 
                                    className="bg-blue-500 h-full transition-all duration-1000"
                                    style={{ width: `${dDayInfo.progress}%` }}
                                ></div>
                            </div>
                        </div>
                    </header>

                    {/* íƒ­ ë„¤ë¹„ê²Œì´ì…˜ */}
                    <div className="max-w-md mx-auto px-4 mt-4 mb-2 sticky top-[100px] z-10">
                        <div className="flex bg-white/90 backdrop-blur-sm rounded-xl p-1 shadow-sm border border-gray-200">
                            {[
                                { id: 'record', label: 'ê¸°ë¡', icon: Activity },
                                { id: 'calendar', label: 'ë‹¬ë ¥', icon: CalendarIcon },
                                { id: 'stats', label: 'í†µê³„', icon: BarChart2 },
                                { id: 'routine', label: 'ë£¨í‹´', icon: List },
                            ].map(tab => (
                                <button
                                    key={tab.id}
                                    onClick={() => setActiveTab(tab.id)}
                                    className={`flex-1 flex flex-col items-center justify-center gap-0.5 py-2 rounded-lg text-[10px] sm:text-xs font-bold transition-all ${
                                        activeTab === tab.id 
                                            ? 'bg-slate-800 text-white shadow-md' 
                                            : 'text-gray-400 hover:text-gray-600'
                                    }`}
                                >
                                    <tab.icon className="mb-0.5" size={16} />
                                    {tab.label}
                                </button>
                            ))}
                        </div>
                    </div>

                    <main className="max-w-md mx-auto px-4 w-full">
                        
                        {/* === [íƒ­ 1] ê¸°ë¡ í™”ë©´ === */}
                        {activeTab === 'record' && (
                            <div className="space-y-6 animate-[fadeIn_0.3s_ease-out]">
                                <form onSubmit={handleSubmit} className="bg-white rounded-2xl shadow-sm border border-gray-200 p-5">
                                    <h2 className="text-base font-bold mb-4 text-slate-800 flex items-center justify-between">
                                        <span>ì˜¤ëŠ˜ì˜ ê¸°ë¡</span>
                                        <span className="text-xs font-normal text-slate-400 bg-slate-100 px-2 py-1 rounded">{formData.date}</span>
                                    </h2>
                                    
                                    <div className="grid grid-cols-2 gap-4 mb-4">
                                        <div className="col-span-2">
                                            <label className="text-xs font-bold text-slate-500 mb-1 block">ë‚ ì§œ ì„ íƒ</label>
                                            <input 
                                                type="date" name="date" required 
                                                value={formData.date} onChange={handleInputChange}
                                                className="w-full p-2 bg-gray-50 rounded-lg border border-gray-200 text-sm"
                                            />
                                        </div>
                                        <div>
                                            <label className="text-xs font-bold text-slate-500 mb-1 block">ì²´ì¤‘ (kg)</label>
                                            <input 
                                                type="number" step="0.1" name="weight" required placeholder="0.0"
                                                value={formData.weight} onChange={handleInputChange}
                                                className="w-full p-2 bg-gray-50 rounded-lg border border-gray-200 text-sm focus:bg-blue-50 focus:border-blue-200 outline-none"
                                            />
                                        </div>
                                        <div>
                                            <label className="text-xs font-bold text-slate-500 mb-1 block">ì„­ì·¨ ì¹¼ë¡œë¦¬</label>
                                            <input 
                                                type="number" name="calories" required placeholder="kcal"
                                                value={formData.calories} onChange={handleInputChange}
                                                className="w-full p-2 bg-gray-50 rounded-lg border border-gray-200 text-sm outline-none focus:bg-orange-50 focus:border-orange-200"
                                            />
                                        </div>
                                    </div>

                                    {/* ë¬´ë¦ í†µì¦ ìŠ¬ë¼ì´ë” */}
                                    <div className="mb-5 bg-red-50 p-3 rounded-xl border border-red-100">
                                        <label className="text-xs font-bold text-red-500 mb-2 flex justify-between">
                                            <span>ë¬´ë¦ í†µì¦ (ê·¼ë¬´ í›„)</span>
                                            <span className="bg-white px-2 py-0.5 rounded-full shadow-sm">{formData.kneePain} / 10</span>
                                        </label>
                                        <input 
                                            type="range" min="0" max="10" name="kneePain"
                                            value={formData.kneePain} onChange={handleInputChange}
                                            className="w-full h-2 bg-red-200 rounded-lg appearance-none cursor-pointer accent-red-500"
                                        />
                                        <div className="flex justify-between text-[10px] text-red-400 mt-1">
                                            <span>í†µì¦ ì—†ìŒ</span>
                                            <span>ê·¹ì‹¬í•¨</span>
                                        </div>
                                    </div>

                                    {/* ìˆ˜ë©´ */}
                                    <div className="mb-4">
                                        <label className="text-xs font-bold text-slate-500 mb-1 block">ìˆ˜ë©´ ì§ˆ (ì•¼ê°„ê·¼ë¬´)</label>
                                        <div className="flex gap-1">
                                            {[1, 2, 3, 4, 5].map((score) => (
                                                <button
                                                    key={score} type="button"
                                                    onClick={() => setFormData(prev => ({ ...prev, sleepQuality: score }))}
                                                    className={`flex-1 h-9 rounded-md text-xs font-bold transition-colors ${
                                                        formData.sleepQuality === score 
                                                            ? 'bg-indigo-500 text-white' 
                                                            : 'bg-gray-100 text-gray-400'
                                                    }`}
                                                >
                                                    {score}
                                                </button>
                                            ))}
                                        </div>
                                    </div>

                                    {/* ë¬¼ ë§ˆì‹œê¸° */}
                                    <div className="mb-4">
                                        <label className="text-xs font-bold text-blue-500 mb-1 flex items-center gap-1">
                                            <Droplets size={12} /> ìˆ˜ë¶„ ì„­ì·¨ (í˜„ì¬: {formData.water}ml)
                                        </label>
                                        <div className="flex gap-2">
                                            <button type="button" onClick={() => handleWaterAdd(250)} className="flex-1 bg-blue-50 text-blue-600 py-2.5 rounded-lg text-xs font-bold hover:bg-blue-100 touch-manipulation">+250ml</button>
                                            <button type="button" onClick={() => handleWaterAdd(500)} className="flex-1 bg-blue-50 text-blue-600 py-2.5 rounded-lg text-xs font-bold hover:bg-blue-100 touch-manipulation">+500ml</button>
                                            <button type="button" onClick={() => setFormData(prev => ({...prev, water: 0}))} className="w-12 bg-gray-100 text-gray-400 rounded-lg flex items-center justify-center touch-manipulation"><Trash2 size={16}/></button>
                                        </div>
                                    </div>

                                    {/* ìš´ë™ ê¸°ë¡ */}
                                    <div className="mb-5">
                                        <label className="text-xs font-bold text-slate-500 mb-1 block">ìš´ë™ ë‚´ìš©</label>
                                        <input 
                                            type="text" name="exercise" placeholder="ì˜ˆ: ìˆí’‹ 10ë¶„, ìŠ¤ì¿¼íŠ¸ 50ê°œ"
                                            value={formData.exercise} onChange={handleInputChange}
                                            className="w-full p-2 bg-gray-50 rounded-lg border border-gray-200 text-sm outline-none focus:bg-green-50 focus:border-green-200"
                                        />
                                    </div>

                                    <button type="submit" className="w-full bg-slate-800 text-white py-4 rounded-xl font-bold shadow-lg active:scale-95 transition-transform flex justify-center items-center gap-2 text-sm touch-manipulation">
                                        <Save size={16} /> ê¸°ë¡ ì €ì¥
                                    </button>
                                </form>

                                {/* ìµœê·¼ ê¸°ë¡ ë¦¬ìŠ¤íŠ¸ */}
                                <div className="space-y-3 pb-10">
                                    <h3 className="text-sm font-bold text-slate-500 ml-1">ìµœê·¼ ê¸°ë¡</h3>
                                    {entries.slice(0, 3).map((entry) => (
                                        <div key={entry.date} className="bg-white p-4 rounded-xl shadow-sm border border-gray-100 flex justify-between items-center">
                                            <div className="flex items-center gap-3">
                                                <div className="bg-slate-100 p-2 rounded-lg text-center min-w-[45px]">
                                                    <span className="block text-[10px] text-slate-400">{entry.date.slice(5,7)}ì›”</span>
                                                    <span className="block text-base font-bold text-slate-700">{entry.date.slice(8,10)}</span>
                                                </div>
                                                <div>
                                                    <div className="flex items-center gap-2">
                                                        <span className="font-bold text-slate-800 text-sm">{entry.weight}kg</span>
                                                        {entry.kneePain >= 5 && <span className="text-[10px] bg-red-100 text-red-600 px-1.5 rounded">ë¬´ë¦í†µì¦ {entry.kneePain}</span>}
                                                    </div>
                                                    <div className="text-[10px] text-slate-500 mt-0.5">
                                                        ğŸ’§ {entry.water || 0}ml | ğŸ˜´ {entry.sleepQuality}ì 
                                                    </div>
                                                </div>
                                            </div>
                                            <button onClick={() => handleDelete(entry.date)} className="text-gray-300 hover:text-red-500 p-2"><Trash2 size={16} /></button>
                                        </div>
                                    ))}
                                </div>
                            </div>
                        )}

                        {/* === [íƒ­ 2] ë‹¬ë ¥ í™”ë©´ === */}
                        {activeTab === 'calendar' && (
                            <div className="bg-white rounded-2xl shadow-sm border border-gray-200 p-4 animate-[fadeIn_0.3s_ease-out]">
                                <div className="flex justify-between items-center mb-4">
                                    <button 
                                        onClick={() => setCurrentDate(new Date(currentDate.getFullYear(), currentDate.getMonth() - 1, 1))}
                                        className="p-2 hover:bg-gray-100 rounded-full"
                                    >
                                        <ChevronLeft size={20} className="text-gray-500" />
                                    </button>
                                    <h2 className="text-base font-bold text-slate-800">
                                        {currentDate.getFullYear()}ë…„ {currentDate.getMonth() + 1}ì›”
                                    </h2>
                                    <button 
                                        onClick={() => setCurrentDate(new Date(currentDate.getFullYear(), currentDate.getMonth() + 1, 1))}
                                        className="p-2 hover:bg-gray-100 rounded-full"
                                    >
                                        <ChevronRight size={20} className="text-gray-500" />
                                    </button>
                                </div>
                                
                                <div className="grid grid-cols-7 gap-1 text-center mb-2">
                                    {['ì¼', 'ì›”', 'í™”', 'ìˆ˜', 'ëª©', 'ê¸ˆ', 'í† '].map(day => (
                                        <div key={day} className="text-xs font-bold text-slate-400 py-1">{day}</div>
                                    ))}
                                </div>
                                <div className="grid grid-cols-7 gap-1">
                                    {renderCalendar()}
                                </div>
                                <div className="mt-4 flex gap-3 justify-center text-[10px] text-slate-500">
                                    <div className="flex items-center gap-1"><div className="w-1.5 h-1.5 rounded-full bg-green-400"></div>ì»¨ë””ì…˜ êµ¿</div>
                                    <div className="flex items-center gap-1"><div className="w-1.5 h-1.5 rounded-full bg-red-400"></div>í†µì¦ ì£¼ì˜</div>
                                    <div className="flex items-center gap-1"><div className="w-1.5 h-1.5 rounded-full bg-purple-400"></div>ìš´ë™ í•¨</div>
                                </div>
                                <p className="text-[10px] text-slate-400 text-center mt-3">ğŸ’¡ ë‚ ì§œë¥¼ í´ë¦­í•˜ë©´ ìˆ˜ì • ê°€ëŠ¥</p>
                            </div>
                        )}

                        {/* === [íƒ­ 3] í†µê³„ í™”ë©´ === */}
                        {activeTab === 'stats' && (
                            <div className="space-y-4 animate-[fadeIn_0.3s_ease-out]">
                                <div className="grid grid-cols-2 gap-3">
                                    <div className="bg-white p-4 rounded-2xl shadow-sm border border-gray-100">
                                        <div className="text-xs text-slate-400 mb-1">ì´ ì²´ì¤‘ ë³€í™”</div>
                                        <div className={`text-xl font-extrabold ${Number(getWeightChange()) <= 0 ? 'text-blue-500' : 'text-red-500'}`}>
                                            {getWeightChange()} kg
                                        </div>
                                    </div>
                                    <div className="bg-white p-4 rounded-2xl shadow-sm border border-gray-100">
                                        <div className="text-xs text-slate-400 mb-1">í‰ê·  ìˆ˜ë©´ í€„ë¦¬í‹°</div>
                                        <div className="text-xl font-extrabold text-indigo-500">{getAverage('sleepQuality')} <span className="text-sm text-gray-400">/ 5.0</span></div>
                                    </div>
                                </div>

                                <div className="bg-white p-5 rounded-2xl shadow-sm border border-gray-100">
                                    <h3 className="text-sm font-bold text-slate-700 mb-3 flex items-center gap-2">
                                        <AlertCircle size={16} className="text-red-500" />
                                        ë¬´ë¦ í†µì¦ ì¶”ì´ (ìµœê·¼ 5ì¼)
                                    </h3>
                                    <div className="flex items-end justify-between h-32 gap-2 mt-2">
                                        {entries.slice(0, 5).reverse().map((entry, idx) => (
                                            <div key={idx} className="flex-1 flex flex-col items-center justify-end group">
                                                <div 
                                                    className={`w-full rounded-t-md transition-all ${entry.kneePain > 5 ? 'bg-red-400' : 'bg-green-300'}`}
                                                    style={{ height: `${(entry.kneePain / 10) * 100}%` }}
                                                ></div>
                                                <div className="text-[10px] text-gray-400 mt-1">{entry.date.slice(8,10)}ì¼</div>
                                            </div>
                                        ))}
                                        {entries.length === 0 && <div className="text-center w-full text-xs text-gray-300 py-10">ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤.</div>}
                                    </div>
                                </div>
                            </div>
                        )}

                        {/* === [íƒ­ 4] ìš´ë™ ë£¨í‹´ ì¶”ì²œ === */}
                        {activeTab === 'routine' && (
                            <div className="space-y-5 animate-[slideInRight_0.3s_ease-out]">
                                
                                <div className="bg-indigo-50 p-4 rounded-2xl border border-indigo-100">
                                    <h3 className="font-bold text-indigo-800 text-base mb-1">ì˜¤ëŠ˜ì˜ ì¶”ì²œ ë£¨í‹´</h3>
                                    <p className="text-xs text-indigo-600 mb-3">
                                        ë¬´ë¦ ìƒíƒœì— ë§ì¶° ì„ íƒí•˜ì„¸ìš”.
                                    </p>
                                    
                                    <div className="flex gap-2 text-xs">
                                        <span className={`px-2 py-1 rounded-full border ${formData.kneePain >= 4 ? 'bg-red-500 text-white border-red-500' : 'bg-white text-gray-400 border-gray-200'}`}>
                                            í†µì¦ ìˆìŒ (4+)
                                        </span>
                                        <span className={`px-2 py-1 rounded-full border ${formData.kneePain < 4 ? 'bg-green-500 text-white border-green-500' : 'bg-white text-gray-400 border-gray-200'}`}>
                                            ì»¨ë””ì…˜ ì¢‹ìŒ
                                        </span>
                                    </div>
                                </div>

                                {/* ë£¨í‹´ A: ìˆí’‹ & Lì ë‹¤ë¦¬ (ìˆœí™˜/ì¬í™œ) */}
                                <div className={`border-l-4 border-red-400 bg-white p-4 rounded-r-xl shadow-sm ${formData.kneePain >= 4 ? 'ring-2 ring-red-200' : 'opacity-70'}`}>
                                    <h4 className="font-bold text-slate-800 flex items-center gap-2 text-sm">
                                        <Footprints size={16} className="text-red-500" />
                                        ë£¨í‹´ A: ìˆí’‹ & í•˜ì²´ ìˆœí™˜
                                    </h4>
                                    <p className="text-xs text-slate-500 mb-3">ë°œì˜ ì•„ì¹˜ë¥¼ ì‚´ë ¤ ë¬´ë¦ ë¶€ë‹´ì„ ì¤„ì´ê³  ë¶“ê¸°ë¥¼ ëºë‹ˆë‹¤.</p>
                                    <ul className="space-y-3 text-sm text-gray-700">
                                        <li className="flex items-start gap-2">
                                            <div className="w-1.5 h-1.5 bg-red-400 rounded-full mt-1.5"></div> 
                                            <div>
                                                <strong>ìˆí’‹ (Short Foot)</strong> - 5ë¶„<br/>
                                                <span className="text-xs text-gray-500">ë°œê°€ë½ì„ í´ê³  ë°œë°”ë‹¥ ì•„ì¹˜ì— í˜ì£¼ê¸°</span>
                                            </div>
                                        </li>
                                        <li className="flex items-start gap-2">
                                            <div className="w-1.5 h-1.5 bg-red-400 rounded-full mt-1.5"></div> 
                                            <div>
                                                <strong>Lì ë‹¤ë¦¬</strong> - 10ë¶„<br/>
                                                <span className="text-xs text-gray-500">ë²½ì— ë‹¤ë¦¬ ê¸°ëŒ€ê³  ëˆ„ì›Œ ë¶“ê¸° ë¹¼ê¸°</span>
                                            </div>
                                        </li>
                                        <li className="flex items-start gap-2">
                                            <div className="w-1.5 h-1.5 bg-gray-400 rounded-full mt-1.5"></div> 
                                            <div>
                                                <strong>í¼ë¡¤ëŸ¬</strong> - ì¢…ì•„ë¦¬/í—ˆë²…ì§€ ì•ë©´
                                            </div>
                                        </li>
                                    </ul>
                                </div>

                                {/* ë£¨í‹´ B: ë§¨ëª¸ í•˜ì²´ & ì½”ì–´ (ë¬´ì‚°ì†Œ) */}
                                <div className={`border-l-4 border-green-400 bg-white p-4 rounded-r-xl shadow-sm ${formData.kneePain < 4 ? 'ring-2 ring-green-200' : 'opacity-70'}`}>
                                    <h4 className="font-bold text-slate-800 flex items-center gap-2 text-sm">
                                        <LayoutGrid size={16} className="text-green-500" />
                                        ë£¨í‹´ B: ë§¨ëª¸ í•˜ì²´ & ì½”ì–´
                                    </h4>
                                    <p className="text-xs text-slate-500 mb-3">ë¬´ë¦ ì¶©ê²©ì€ ì¤„ì´ê³  ì†ê·¼ìœ¡ì„ ì±„ìš°ëŠ” ë°”ë””ì›¨ì´íŠ¸.</p>
                                    <ul className="space-y-3 text-sm text-gray-700">
                                        <li className="flex items-start gap-2">
                                            <div className="w-1.5 h-1.5 bg-green-500 rounded-full mt-1.5"></div> 
                                            <div>
                                                <strong>ê¸€ë£¨íŠ¸ ë¸Œë¦¿ì§€</strong> - 15íšŒ x 3ì„¸íŠ¸<br/>
                                                <span className="text-xs text-gray-500">ëˆ„ì›Œì„œ ì—‰ë©ì´ ë“¤ê¸°</span>
                                            </div>
                                        </li>
                                        <li className="flex items-start gap-2">
                                            <div className="w-1.5 h-1.5 bg-green-500 rounded-full mt-1.5"></div> 
                                            <div>
                                                <strong>ë°ë“œë²„ê·¸ (Deadbug)</strong> - 20íšŒ x 3ì„¸íŠ¸<br/>
                                                <span className="text-xs text-gray-500">ëˆ„ì›Œì„œ íŒ”ë‹¤ë¦¬ êµì°¨ (ì½”ì–´ ê°•í™”)</span>
                                            </div>
                                        </li>
                                        <li className="flex items-start gap-2">
                                            <div className="w-1.5 h-1.5 bg-green-500 rounded-full mt-1.5"></div> 
                                            <div>
                                                <strong>í´ë¨ì‰˜ (Clamshell)</strong> - ê° 15íšŒ<br/>
                                                <span className="text-xs text-gray-500">ì˜†ìœ¼ë¡œ ëˆ„ì›Œ ë¬´ë¦ ë²Œë¦¬ê¸° (ì¤‘ë‘”ê·¼)</span>
                                            </div>
                                        </li>
                                    </ul>
                                </div>

                                <div className="bg-orange-50 p-4 rounded-xl border border-orange-100 mt-4">
                                    <h4 className="font-bold text-orange-800 text-sm mb-2">ğŸŒ™ ê¿€íŒ</h4>
                                    <p className="text-xs text-orange-700">
                                        ì•¼ê°„ ê·¼ë¬´ í›„ ì½”í‹°ì¡¸ ìˆ˜ì¹˜ê°€ ë†’ì„ ë• ê³¼ê²©í•œ ìš´ë™ë³´ë‹¤ <strong>ë£¨í‹´ A</strong> í›„ ë”°ëœ»í•œ ë¬¼ ìƒ¤ì›Œê°€ ìˆ˜ë©´ì— ë„ì›€ì´ ë©ë‹ˆë‹¤.
                                    </p>
                                </div>
                            </div>
                        )}
                    </main>
                </div>
            );
        }

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
